{
    "0-20": " we shall now take up the essence of what locality sensitive hashing is all about by defining an abstract notion of an lsh family of hash functions using this abstract definition we show how to build new families out of old families in such a way that the new family has a steeper S curve than the original family the construction we use are are quite",
    "20-40": " analogous to the way we worked with minhash functions which are an example of an lsh family and use the combination into bands to steepen the S curve before proceeding we need to explain something about what a hash function in the sense of an lsh family really",
    "40-60": " is uh technically a hash function H in this sense takes two arguments X and Y which are elements whose similarity or distance we are interested in the hash function returns a decision about this pair Yes means that they are a candidate pair and we need to calculate their similarity we can think of yes is saying",
    "60-80": " X and Y belong to the same bucket when a hash function H is used uh but the answer no means that X and Y is not a candidate pair according to this hash function for example A Min hash function can be viewed as taking two sets X and Y Computing the Min hash values According to some per permutation associated with",
    "80-100": " that hash function and saying yes if and only if the Min hash values are the same in many cases there will be a calculation of values behind behind the scenes and the yes answers are made when the values are the same however the view we are taking now is more General since there need not be a computation of values that are then compared and as we",
    "100-120": " shall see that we really need this generality for example we should look at lsh families that render their decisions by looking at many values and saying yes if there is at least one equality however to make things look more normal we shall often use the Expression H ofx equal h of Y to mean",
    "120-140": " that h of X and Y is yes okay so here's the definition of an lsh family of hash functions uh first these families of hash functions each assumed data consists of a space of points with a distance measured for that space for example the family of Minash functions assumes the space of points is sets and",
    "140-160": " the distance is the jard distance there is no notion of a family of hash functions being sensitive in some absolute sense uh but rather we can make statements about a family h of hash functions in terms of four parameters there are two distances D1",
    "160-180": " and D2 and there are two probabilities P1 and P2 of the two distance one is a small distance that's D1 and the other is a large distance the probability P1 is",
    "180-200": " associated with the small distance and it is a lower bound on the probability of agreement for points at distance D1 or less the second probability P2 is associated with the large distance and it is an upper bound on the probability of agreement for points at distance D2 and more we expect P1 to be large and P2",
    "200-220": " to be small okay more formally for any two points X and Y by a distance up to D1 the probability considering all hash functions little H and the family Capital H that's that little H says yes about X and Y is at least",
    "220-240": " P1 and if the distance between X and Y is at least D2 then the probability that little H says yes for x and y is at most P2 here's a picture of what we know about the probability of H ofx equaling h of Y for distances D1 and Below we know the",
    "240-260": " probability is at least P1 and for distances D2 and above we know the probability is at most P2 between D1 and D2 We Know Nothing uh however we shall try to make the difference between D1 and D2 very small and the distance between P1 and P2 as large as we can",
    "260-280": " okay that will give us the S curve we want although since we are now talking about distances rather than similarities the S curve is backwards it drops down precipitously between the distances D1 and D2 rather than Rising precipitously so it look something like this let's take as our example the only",
    "280-300": " example we know the underlying space consists of sets all subsets of some Universal set and the distance measure is jakar distance the lsh family is the family of minhash functions each based on one of the possible permutations of the members of the universal set of elements we claim the probability that a",
    "300-320": " given Minash function H gives the same value for sets X and Y is one minus the jard distance from X to Y that's just a restatement of the theorem about how the jard similarity is the probability that two sets agree on a random Min hash function uh notice that one minus the jard distance is the jard",
    "320-340": " similarity we claim that the family of Min hash functions is a 1/3 2/3 2/3 1/3 sensitive family for the space s of sets and the jakar distance D for example the first and third parameter say that if the distance is at most",
    "340-360": " 1/3 then the probability of agreement is at least 2/3 but that makes sense because if the distance is at most 1/3 then the jacard similarity is at least 2/3 and we know that the probability of agreement equals the similarity okay likewise the second and fourth parameter say that whenever the",
    "360-380": " jard distance is at least 2/3 so that the similarity is is at most 1/3 the probability of agreement is at most oneir we can make many statements like this about the family of Minash hash functions there's nothing special about 1/3 to 2/3 in fact for any distances D1",
    "380-400": " and D2 as long as D1 is less than D2 the Minash functions form a family with sensitivity D1 D2 1 minus D1 1 minus D2 when we start with a simple lsh family such as the set of Minash functions we don't get the S curve",
    "400-420": " effect however we're going to see that it is possible to amplify the steepness of the S curve using two constructions that produce a new lsh family from a given lsh family these constructions are like are like what we've already seen for the Min hash functions uh in particular what we call the and construction is essentially the",
    "420-440": " combination of the effect of several rows in one band and the or construction is the combination of several bands so here is the and construction we're given an lsh family H and we want to construct from it a new family H Prime each hash function from H",
    "440-460": " Prime is built from R functions from h a hash function little H in the family H Prime is constructed from a set of R hash functions from family H say H1 through HR little H renders its decision about a pair of elements X and Y by checking",
    "460-480": " that each hash function in the set renders the decision yes using our convention that H ofx equals h of y means that the answer for X and Y is yes we can write the rule for H as shown that is is H of xal H of Y if and",
    "480-500": " only if h i of xal h i of Y for all I where I ranges now from one to R the family H Prime amplifies the effect of H according to the rule given here the lower and upper distances D1",
    "500-520": " and D2 don't change however the two probabilities are each raised to the r power that is in order to get get a yes from hash function H we have to get yes from each of the hi the family H Prime consists of all possible sets of R members of family age so the hiis for a given age can be",
    "520-540": " viewed as randomly Chosen and thus independent uh remember that the rule for the probability of independent events occurring simultaneously is the product of the probabilities of the individual events the and construction corresponds to combining rows in a band we also have an or construction",
    "540-560": " that corresponds to combining bands again we'll start with an lsh family H and con and construct a new family H Prime each member of H Prime will be constructed from a set of B functions from H let little little H be a typical member of the family H Prime and let X",
    "560-580": " and Y be elements to which we want to apply little H then we say h of xal H of Y if and only if hi I of x equal hi of Y for at least one value of I in the range o1 to B okay notice that the expression h of xal H of Y really is shorthand for the",
    "580-600": " way H looks at both X and Y and decides whether or not to make them a candidate pair we cannot explain what is going on by supposing that h computes a value from X and a value from Y and simply asks if they are equal",
    "600-620": " so here's the rule for the sensitivity of family H Prime in terms of the sensitivity of H as for the and construction the distance components D1 and D2 do not change but the probabilities are altered according to the rule for the probability of the ore of independent events okay to see how this combination",
    "620-640": " works think of at least one of these events occurs in its equivalent form it is not true that none of these events occurs if each event occurs with probability P1 then the probability it doesn't occur is one minus P1 the probability that none of B events occurs is that rais to the be",
    "640-660": " power and one minus that is the probability that none of them occur is false that is at least one of the B events occurs the same same transformation applies to the other",
    "660-680": " other probability P2 of course so here's a summary of what happens when we apply the and and or constructions and makes both the high and low probabilities shrink because we're taking two probabilities which are less than one and raising them to the",
    "680-700": " arth power what we need to do is pick R big enough so that the low probability becomes close to zero yet pick R small enough the high probability stays significantly above zero it's a balancing act but we'll see in a moment how it works in practice the analogous story applies to The Ore construction both probabilities",
    "700-720": " grow but we contrive to select the value of B that makes the high probability get very close to one while still keeping the low probability significantly away from one now we need to see how to compose the and inor constructions in order order to wind up with an lsh family",
    "720-740": " where the low probability is essentially zero and the high probability is essentially one that's the ideal for the s-curve remember in the case of signature matrices and the band construction we did the and construction combining rows in a band followed by the or construction combining bands but we could actually have done these in the",
    "740-760": " reverse order and it is also possible to use a sequence of more than two of the and and or constructions alternating and we'll see how to do the that works in a moment but suppose we do the rway and construction followed by the bway or construction the and construction turns",
    "760-780": " a probability P into P to the r then the or construction turns P to the R into this function notice that what we have is exactly the XS curve that we constructed when we originally d discussed lsh from",
    "780-800": " Minash functions we're going to do an example on the next slide where R and B are both four that is starting with some lsh family H we do a four-way and construction to get a family H Prime and then use H Prime to do a",
    "800-820": " four-way or construction to get a new family H double Prime so here's a table of what happens to the probability P when you apply the four-way and followed by the four-way or we can pick the lower and upper distances D1 and D2 as we",
    "820-840": " like for example here's what happens if we choose the lower distance D1 to be 02 and the upper distance D2 to be 08 and the underlying lsh family is the Minash functions we start with a. 2.88 point2 f family the constructed",
    "840-860": " family has the same distances 2 and8 uh but if you substitute P equal 8 in this formula well you get this uh you get 8785 so the upper",
    "860-880": " probability is raised that's good and if you substitute p = 2 in the same formula you get 0064 so the lower probability is lowered that's also good we also have the option of starting with a bway or construction and then",
    "880-900": " doing an rway and construction the or construction turns any probability P into this expression and then the an construction raises those probabilities to the arth power giving this formula the S curve you get from this sequence",
    "900-920": " of constructions is related to what you get if you start with the rway and and then do the B way or starting with that curve you mirror it vertically and then mirror it horizontally or mirror it first horizontally then vertically it doesn't matter the result will be the curve for this",
    "920-940": " expression we'll again do an example on the next slide it is a four-way or followed by a four-way and so uh here here the table for the or and construction each using four uh from the previous lsh family let's see what you get when you",
    "940-960": " start with the Minash functions thought of as a point to. 8.8.2 sensitive family looking up the values for probabilities point8 and2 in the table you see you get a much higher probability for the low the low distance pairs that's this",
    "960-980": " uh and you also get a somewhat lower probability for the distance Pairs and so again both have been improved we are free to apply construction after construction and if we pick the right values of R andb we'll keep improving both probabilities driving the low one toward zero and the",
    "980-1000": " high one toward one for example we could apply the or followed by and construction we just discussed and then apply the and followed by or construction discussed earlier that by the way would be the same as applying a four-way ore then a 16-way and and finally another four-way or notice that each construction uses 16",
    "1000-1020": " of the original functions so by cascading these two constructions we use 256 Minash functions if you do the math you'll find that it transforms the Minash functions thought of as a point 2.88 point2 sensitive family into",
    "1020-1040": " this the probability of saying yes for sets at Jak card distance point two or less is this which is almost precisely one that is there are very very few false negatives but the probability of saying yes for sets at your card distance point8 or more is this very",
    "1040-1060": " small probability thus at least among pairs that are really far apart the number of false positives is Tiny uh you might look at this analysis and observe that we don't know anything about what happens between for similarities uh between 0 2 and 08 and",
    "1060-1080": " that's a big range however suppose our application is shingled web documents if we take two random web pages and we have used a large enough shingle length say nine or 10 then two random documents will have very small jard similarity and thus a jard distance above point8 only if there",
    "1080-1100": " is some special cause for similarity say a mirror page or plagiarism will the jard distance be low and in those cases we expect it to be very low probably under 0.2 that is to say there simply aren't many pairs at distance between 0 2 and 8 in this application the conclusion is that for the par particular application we might",
    "1100-1120": " be happy with this distances 0 2 and 08 but we are free to make the distances be whatever we want want as long as the first is less than the second for example we could start with a 49. 51. [Music]",
    "1120-1140": " 5149 uh sensitive family and do constructions that would drive the probabilities uh are initially 0 51 and 049 close to one and zero respectively uh of course we would need many more than 256 of the base functions to get such a steep uh S",
    "1140-1160": " curve what I'd like to do now is explain how to select the values of R and B for and theor constructions let's look at the function that we've called the scurve that's this this is a function of the",
    "1160-1180": " probability p and it has two parameters R and B an interesting observation is that this curve okay let's draw something like that here uh it has a fixed Point t such that if P",
    "1180-1200": " equals T then the result of applying the function to T is T to see that t exists look at where the curve intersects the line with slope one so that would be the value of T above probability T applying the S curve function increases the probability",
    "1200-1220": " while below T the probability decreases we can conclude that as long as the two probabilities are on opposite sides of T the construction where you do an rway and followed by a bway or will move both probabilities in the direction we want them to go we can then iterate this construction as many times as we",
    "1220-1240": " like and both probabilities will keep improving there's an analogous observation about a construction where we and or followed by an and the S curve formula is a little different but the ideas are quite the same here's a picture suggesting what happens for the S curves that we get for",
    "1240-1260": " both the and and or and or and constructions the threshold is defined by the place where the S curve and the straight line cross okay for probabilities P below T applying the S curve function lower is the",
    "1260-1280": " probability well for probabilities above T the S curve sends P to a higher probability"
}